<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vinnie QR Generator</title>
<style>
    /* GENERAL STYLES */
    body {
        font-family: 'Segoe UI', Arial, sans-serif;
        background: #0d0d0d;
        color: #fff;
        margin: 0;
        padding: 0;
        text-align: center;
    }
    h1 {
        margin-top: 20px;
        color: #00f0ff;
        text-shadow: 0 0 10px #00f0ff, 0 0 20px #ff00ff;
    }

    /* MUSIC CONTROLS */
    .music-controls {
        margin: 20px 0;
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
    }
    .music-controls button {
        padding: 12px 18px;
        margin: 5px;
        border-radius: 10px;
        border: none;
        cursor: pointer;
        font-weight: bold;
        color: #fff;
        background: linear-gradient(45deg,#ff0066,#00ffff,#ffcc00,#ff00ff);
        background-size: 300% 300%;
        animation: gradientBG 5s ease infinite;
        transition: transform 0.2s;
        min-width: 80px;
    }
    .music-controls button:active {
        transform: scale(0.95);
    }
    @keyframes gradientBG {
        0% {background-position:0% 50%;}
        50% {background-position:100% 50%;}
        100% {background-position:0% 50%;}
    }

    /* QR & SPINNER */
    #qrcode { margin-top: 20px; }
    .loader {
        border: 6px solid #222;
        border-top: 6px solid #0ff;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        animation: spin 1s linear infinite;
        margin: auto;
        box-shadow: 0 0 20px #0ff;
    }
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    #spinner { display: none; margin-top: 20px; }

    /* MODAL */
    .modal {
        display: none;
        position: fixed;
        z-index: 100;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0,0,0,0.85);
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 10px;
    }
    .modal-content {
        background: #111;
        width: 95%;
        max-width: 360px;
        padding: 20px;
        border-radius: 15px;
        border: 3px solid;
        border-image-slice: 1;
        border-width: 3px;
        border-image-source: linear-gradient(45deg,#ff0066,#00ffff,#ffcc00,#ff00ff);
        animation: borderGlow 4s linear infinite;
        box-shadow: 0 0 20px #00ffff, 0 0 40px #ff00ff;
    }
    @keyframes borderGlow {
        0% { border-image-source: linear-gradient(45deg,#ff0066,#00ffff,#ffcc00,#ff00ff);}
        25% { border-image-source: linear-gradient(45deg,#ff00ff,#ffcc00,#00ffff,#ff0066);}
        50% { border-image-source: linear-gradient(45deg,#00ffff,#ff0066,#ff00ff,#ffcc00);}
        75% { border-image-source: linear-gradient(45deg,#ffcc00,#ff00ff,#00ffff,#ff0066);}
        100% { border-image-source: linear-gradient(45deg,#ff0066,#00ffff,#ffcc00,#ff00ff);}
    }
    .modal-content label {
        display: block;
        margin-top: 10px;
        color: #0ff;
        font-weight: bold;
    }
    .modal-content input {
        width: 100%;
        padding: 8px;
        margin-top: 5px;
        border-radius: 8px;
        border: none;
        font-weight: bold;
        text-align: left;
    }
    .modal-content input:disabled {
        background: #222;
        color: #888;
        font-style: italic;
    }
    .modal-content button {
        margin-top: 15px;
        width: 48%;
        font-weight: bold;
        padding: 10px;
        border-radius: 10px;
        border: none;
        color: #fff;
        cursor: pointer;
        background: linear-gradient(45deg,#ff0066,#00ffff,#ffcc00,#ff00ff);
        background-size: 300% 300%;
        animation: gradientBG 5s ease infinite;
        transition: transform 0.2s;
    }
    .modal-content button:active { transform: scale(0.95); }

    /* FOOTER */
    .footer {
        background: #111;
        color: #fff;
        padding: 15px;
        margin-top: 50px;
        font-size: 14px;
    }
    .footer button {
        margin-left: 10px;
        padding: 5px 10px;
        font-size: 12px;
        border-radius: 5px;
        border: none;
        font-weight: bold;
        cursor: pointer;
        background: linear-gradient(45deg,#ff0066,#00ffff,#ffcc00,#ff00ff);
        background-size: 300% 300%;
        animation: gradientBG 5s ease infinite;
        color: #fff;
    }

    /* RESPONSIVE */
    @media(max-width:400px){
        .music-controls button {
            font-size: 14px;
            padding: 10px;
            min-width: 60px;
        }
        .modal-content { padding: 15px; }
        h1 { font-size: 22px; }
    }
</style>
</head>
<body>

<h1>Vinnie QR Generator</h1>

<!-- Music Controls -->
<div class="music-controls">
    <button onclick="prevMusic()">⏮ Prev</button>
    <button onclick="toggleMusic()" id="playPauseBtn">⏸ Pause</button>
    <button onclick="nextMusic()">⏭ Next</button>
</div>
<audio id="musicPlayer" autoplay></audio>

<!-- Generate QR Button -->
<button onclick="openModal()">Generate QR Code</button>

<!-- Spinner -->
<div id="spinner">
    <div class="loader"></div>
    <p>Generating QR...</p>
</div>

<!-- QR Code -->
<div id="qrcode"></div>
<button id="downloadBtn" style="display:none;" onclick="downloadQR()">Download QR</button>

<!-- MODAL -->
<div id="qrModal" class="modal">
    <div class="modal-content">
        <h3 style="color:#ff0;">Enter Your Details</h3>
        <label>Admission Number:</label>
        <input type="text" id="admissionNo" placeholder="B14/5654/2026">

        <label>Name:</label>
        <input type="text" id="studentName" placeholder="Kimani Charity Kemboi">

        <label>Programme:</label>
        <input type="text" id="programme" placeholder="Leave this blank" disabled>

        <label>Stage:</label>
        <input type="text" id="stage" placeholder="Y1S1">

        <label>Semester:</label>
        <input type="text" id="semester" value="SEP-DEC25" disabled>

        <label>RegNo:</label>
        <input type="text" id="regNo" disabled>

        <button onclick="submitForm()">Submit</button>
        <button onclick="closeModal()">Cancel</button>
    </div>
</div>

<!-- FOOTER -->
<div class="footer">
    Thank you for using Vinnie QR Code Generator. If you like, you can donate to this Till <span id="tillNumber">4646254</span>
    <button onclick="copyTill()">Copy Till</button>
</div>

<!-- QR Library -->
<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>

<script>
// ------------------ MUSIC ------------------
let musicFiles = ["music1.mp3","music2.mp3","music3.mp3","music4.mp3","music5.mp3"];
let currentMusic = 0;
let player = document.getElementById("musicPlayer");
player.src = musicFiles[currentMusic];
player.addEventListener('ended', nextMusic);

function nextMusic() {
    currentMusic = (currentMusic + 1) % musicFiles.length;
    player.src = musicFiles[currentMusic];
    player.play();
    document.getElementById("playPauseBtn").innerText = "⏸ Pause";
}
function prevMusic() {
    currentMusic = (currentMusic -1 + musicFiles.length)%musicFiles.length;
    player.src = musicFiles[currentMusic];
    player.play();
    document.getElementById("playPauseBtn").innerText = "⏸ Pause";
}
function toggleMusic() {
    if(player.paused){ player.play(); document.getElementById("playPauseBtn").innerText="⏸ Pause"; }
    else{ player.pause(); document.getElementById("playPauseBtn").innerText="▶ Play"; }
}

// ------------------ MODAL ------------------
function openModal(){ document.getElementById("qrModal").style.display="flex"; }
function closeModal(){ document.getElementById("qrModal").style.display="none"; }

// ------------------ FORM & QR ------------------
function submitForm(){
    let admission=document.getElementById("admissionNo").value.trim();
    let name=document.getElementById("studentName").value.trim();
    let stage=document.getElementById("stage").value.trim();
    if(admission===""||name===""||stage===""){ alert("Please fill all editable fields!"); return; }
    closeModal();
    document.getElementById("spinner").style.display="block";
    document.getElementById("qrcode").innerHTML="";
    document.getElementById("downloadBtn").style.display="none";

    setTimeout(()=>{
        document.getElementById("spinner").style.display="none";
        let regNo="REGNO-"+Math.floor(10000+Math.random()*90000);
        document.getElementById("regNo").value=regNo;
        let semester=document.getElementById("semester").value;
        let programme=document.getElementById("programme").value;

        let qrText=`Student No: ${admission} | Name: ${name} | Programme: ${programme} | Stage: ${stage} | Semester: ${semester} | RegNo: ${regNo}`;
        QRCode.toCanvas(qrText,{width:250},function(err,canvas){
            if(err) console.error(err);
            document.getElementById("qrcode").appendChild(canvas);
            document.getElementById("downloadBtn").style.display="inline-block";
        });
    },3000);
}

// ------------------ DOWNLOAD ------------------
function downloadQR(){
    let canvas=document.querySelector("#qrcode canvas");
    let link=document.createElement("a");
    link.href=canvas.toDataURL("image/png");
    link.download="QR_Code.png";
    link.click();
}

// ------------------ COPY TILL ------------------
function copyTill(){
    let till=document.getElementById("tillNumber").innerText;
    navigator.clipboard.writeText(till).then(()=>{ alert("Till number copied!"); });
}
</script>
</body>
</html>
